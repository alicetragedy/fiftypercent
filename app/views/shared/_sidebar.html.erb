<aside class="widget">
<%= link_to new_event_path, class: 'btn btn-sidebar', style: 'width: 100%;' do %>
  <span class="glyphicon glyphicon-plus-sign"></span>
  <%= t 'layout.sidebar.add_new_event_html' %>
<% end %>
</aside>

<aside class="widget" id="sidebar-search">
  <h1><%= t 'layout.sidebar.search' %></h1>
  <%= form_tag(events_path, method: 'get', class: 'form-inline search', role: 'form') do %>
    <div class="form-group">
      <%= text_field_tag(:q, params[:q],  {class: 'form-control',
                                           placeholder: t('layout.sidebar.searchterm')
                                           }) %>
    </div>
    <%= button_tag( :class => "btn btn-sidebar") do %>
      <span class="glyphicon glyphicon-search"></span>
    <% end %>
  <% end %>
</aside>


<aside class="widget" id="statistics">
  <h1><%= t 'layout.sidebar.statistics' %></h1>
  <p>
    <%= t 'layout.sidebar.statistics_statement_html',
          {event_count: Event.count,
           total: total = Event.pluck(:total).compact.sum,
           women: woman = Event.pluck(:woman).compact.sum,
           percent: number_with_precision((woman.to_f / total.to_f) * 100, precision: 2)
           }%>
    <% total = Event.pluck(:total).compact.sum %>
    <% woman = Event.pluck(:woman).compact.sum %>
    <% percent_woman= number_with_precision((woman.to_f / total.to_f) * 100, precision: 2) %>
    <%= render 'events/all_events_donut', percent: percent_woman.to_i %>
  </p>
</aside>

<% Page.sidebar_snippets.order(:rank).includes(:translations).all.each do |snippet| %>
  <aside class="widget" id="<%= dom_id(snippet) %>">
    <h1><%= snippet.title %></h1>
    <%= markdown(snippet.body) %>
  </aside>
<% end %>

<aside class="widget" id="page-list">
  <h1><%= t 'layout.sidebar.more' %></h1>
  <ul class="list-unstyled">
    <% Page.menu_pages.order(:rank).includes(:translations).all.each do |page| %>
      <li>
        <%= link_to page_path(page.slug) do %>
          <span class="glyphicon glyphicon-file"></span>
          <%= page.title %>
        <% end %>
      </li>
    <% end %>
  </ul>
</aside>

<aside class="widget" id="tags">
  <h1>Tags</h1>
  <div id='tag_cloud'>
    <% tag_cloud Event.tag_counts, %w[s m l] do |tag, css_class| %>
      <%= link_to tag.name, tag_path(tag.name), class: css_class %>
    <% end %>
  </div>
</aside>

<aside class="widget text-right">
  <%= link_to admin_root_path, title: "Admin" do %>
    <span class="glyphicon glyphicon-cog"></span>
  <% end %>
</aside>
